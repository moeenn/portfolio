---
import fs from "node:fs";
import type { CollectionEntry } from "astro:content";
import { formatDate } from "../lib/datetime";

type Props = {
	post: CollectionEntry<"blog">;
	index: number;
};

const index = Astro.props.index;
const post = Astro.props.post;
const dateModified = new Date(fs.statSync(post.filePath ?? "").mtime);
---

<a
	data-post
	data-post-category={post.data.category}
	data-post-tags={JSON.stringify(post.data.tags)}
	href={`/blogs/${post.id}`}
	class={"w-full p-6 border border-gray-300 hover:-transtone-y-2 hover:shadow-lg transition-all rounded" +
		(index > 4 ? " content-auto" : "")}
>
	<div class="flex flex-col h-full">
		<div class="flex justify-between">
			<span
				class="leading-none px-3 py-1 rounded-full bg-black text-white text-xs font-medium"
			>
				{post.data.category}
			</span>

			<span class="text-xs my-auto text-stone-600">
				{formatDate(dateModified)}
			</span>
		</div>

		<h4 class="text-black text-xl font-medium mt-3">
			{post.data.title}
		</h4>
		<p class="flex-1 text-gray-700 leading-relaxed py-b pt-3">
			{post.data.desc}
		</p>

		<hr class="border-b border-gray-200 my-4" />

		<div class="flex flex-wrap gap-2">
			{
				post.data.tags.map((t) => (
					<span class="bg-gray-200 text-gray-800 rounded px-3 py-1 text-xs">
						{t}
					</span>
				))
			}
		</div>
	</div>
</a>
